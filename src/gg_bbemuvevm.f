function sgg_bbemuvevm(p1, p2, p3, p4, p5, p6, p7, p8)

    ! function generated by madgraph
    ! returns amplitude squared summed/avg over colors
    ! and helicities
    ! for the point in phase space p1,p2,p3,p4,...

    ! for process : g g  -> b b~ mu+ e- ve~ vm

    implicit none

    real*8 :: sgg_bbemuvevm

    ! constants
    integer, parameter :: nexternal = 8, ncomb = 256

    ! arguments
    real*8 :: p1(0:3),p2(0:3),p3(0:3),p4(0:3),p5(0:3),p6(0:3),p7(0:3),p8(0:3)

    ! local variables
    integer :: nhel(nexternal,ncomb),ntry
    real*8 :: t
    real*8 :: gg_bbemuvevm
    integer :: ihel
    logical :: goodhel(ncomb)
    data goodhel/ncomb* .false. /
    data ntry/0/
    data (nhel(ihel,  1),ihel=1,8) / -1, -1, -1, -1, -1, -1, -1, -1/
    data (nhel(ihel,  2),ihel=1,8) / -1, -1, -1, -1, -1, -1, -1,  1/
    data (nhel(ihel,  3),ihel=1,8) / -1, -1, -1, -1, -1, -1,  1, -1/
    data (nhel(ihel,  4),ihel=1,8) / -1, -1, -1, -1, -1, -1,  1,  1/
    data (nhel(ihel,  5),ihel=1,8) / -1, -1, -1, -1, -1,  1, -1, -1/
    data (nhel(ihel,  6),ihel=1,8) / -1, -1, -1, -1, -1,  1, -1,  1/
    data (nhel(ihel,  7),ihel=1,8) / -1, -1, -1, -1, -1,  1,  1, -1/
    data (nhel(ihel,  8),ihel=1,8) / -1, -1, -1, -1, -1,  1,  1,  1/
    data (nhel(ihel,  9),ihel=1,8) / -1, -1, -1, -1,  1, -1, -1, -1/
    data (nhel(ihel, 10),ihel=1,8) / -1, -1, -1, -1,  1, -1, -1,  1/
    data (nhel(ihel, 11),ihel=1,8) / -1, -1, -1, -1,  1, -1,  1, -1/
    data (nhel(ihel, 12),ihel=1,8) / -1, -1, -1, -1,  1, -1,  1,  1/
    data (nhel(ihel, 13),ihel=1,8) / -1, -1, -1, -1,  1,  1, -1, -1/
    data (nhel(ihel, 14),ihel=1,8) / -1, -1, -1, -1,  1,  1, -1,  1/
    data (nhel(ihel, 15),ihel=1,8) / -1, -1, -1, -1,  1,  1,  1, -1/
    data (nhel(ihel, 16),ihel=1,8) / -1, -1, -1, -1,  1,  1,  1,  1/
    data (nhel(ihel, 17),ihel=1,8) / -1, -1, -1,  1, -1, -1, -1, -1/
    data (nhel(ihel, 18),ihel=1,8) / -1, -1, -1,  1, -1, -1, -1,  1/
    data (nhel(ihel, 19),ihel=1,8) / -1, -1, -1,  1, -1, -1,  1, -1/
    data (nhel(ihel, 20),ihel=1,8) / -1, -1, -1,  1, -1, -1,  1,  1/
    data (nhel(ihel, 21),ihel=1,8) / -1, -1, -1,  1, -1,  1, -1, -1/
    data (nhel(ihel, 22),ihel=1,8) / -1, -1, -1,  1, -1,  1, -1,  1/
    data (nhel(ihel, 23),ihel=1,8) / -1, -1, -1,  1, -1,  1,  1, -1/
    data (nhel(ihel, 24),ihel=1,8) / -1, -1, -1,  1, -1,  1,  1,  1/
    data (nhel(ihel, 25),ihel=1,8) / -1, -1, -1,  1,  1, -1, -1, -1/
    data (nhel(ihel, 26),ihel=1,8) / -1, -1, -1,  1,  1, -1, -1,  1/
    data (nhel(ihel, 27),ihel=1,8) / -1, -1, -1,  1,  1, -1,  1, -1/
    data (nhel(ihel, 28),ihel=1,8) / -1, -1, -1,  1,  1, -1,  1,  1/
    data (nhel(ihel, 29),ihel=1,8) / -1, -1, -1,  1,  1,  1, -1, -1/
    data (nhel(ihel, 30),ihel=1,8) / -1, -1, -1,  1,  1,  1, -1,  1/
    data (nhel(ihel, 31),ihel=1,8) / -1, -1, -1,  1,  1,  1,  1, -1/
    data (nhel(ihel, 32),ihel=1,8) / -1, -1, -1,  1,  1,  1,  1,  1/
    data (nhel(ihel, 33),ihel=1,8) / -1, -1,  1, -1, -1, -1, -1, -1/
    data (nhel(ihel, 34),ihel=1,8) / -1, -1,  1, -1, -1, -1, -1,  1/
    data (nhel(ihel, 35),ihel=1,8) / -1, -1,  1, -1, -1, -1,  1, -1/
    data (nhel(ihel, 36),ihel=1,8) / -1, -1,  1, -1, -1, -1,  1,  1/
    data (nhel(ihel, 37),ihel=1,8) / -1, -1,  1, -1, -1,  1, -1, -1/
    data (nhel(ihel, 38),ihel=1,8) / -1, -1,  1, -1, -1,  1, -1,  1/
    data (nhel(ihel, 39),ihel=1,8) / -1, -1,  1, -1, -1,  1,  1, -1/
    data (nhel(ihel, 40),ihel=1,8) / -1, -1,  1, -1, -1,  1,  1,  1/
    data (nhel(ihel, 41),ihel=1,8) / -1, -1,  1, -1,  1, -1, -1, -1/
    data (nhel(ihel, 42),ihel=1,8) / -1, -1,  1, -1,  1, -1, -1,  1/
    data (nhel(ihel, 43),ihel=1,8) / -1, -1,  1, -1,  1, -1,  1, -1/
    data (nhel(ihel, 44),ihel=1,8) / -1, -1,  1, -1,  1, -1,  1,  1/
    data (nhel(ihel, 45),ihel=1,8) / -1, -1,  1, -1,  1,  1, -1, -1/
    data (nhel(ihel, 46),ihel=1,8) / -1, -1,  1, -1,  1,  1, -1,  1/
    data (nhel(ihel, 47),ihel=1,8) / -1, -1,  1, -1,  1,  1,  1, -1/
    data (nhel(ihel, 48),ihel=1,8) / -1, -1,  1, -1,  1,  1,  1,  1/
    data (nhel(ihel, 49),ihel=1,8) / -1, -1,  1,  1, -1, -1, -1, -1/
    data (nhel(ihel, 50),ihel=1,8) / -1, -1,  1,  1, -1, -1, -1,  1/
    data (nhel(ihel, 51),ihel=1,8) / -1, -1,  1,  1, -1, -1,  1, -1/
    data (nhel(ihel, 52),ihel=1,8) / -1, -1,  1,  1, -1, -1,  1,  1/
    data (nhel(ihel, 53),ihel=1,8) / -1, -1,  1,  1, -1,  1, -1, -1/
    data (nhel(ihel, 54),ihel=1,8) / -1, -1,  1,  1, -1,  1, -1,  1/
    data (nhel(ihel, 55),ihel=1,8) / -1, -1,  1,  1, -1,  1,  1, -1/
    data (nhel(ihel, 56),ihel=1,8) / -1, -1,  1,  1, -1,  1,  1,  1/
    data (nhel(ihel, 57),ihel=1,8) / -1, -1,  1,  1,  1, -1, -1, -1/
    data (nhel(ihel, 58),ihel=1,8) / -1, -1,  1,  1,  1, -1, -1,  1/
    data (nhel(ihel, 59),ihel=1,8) / -1, -1,  1,  1,  1, -1,  1, -1/
    data (nhel(ihel, 60),ihel=1,8) / -1, -1,  1,  1,  1, -1,  1,  1/
    data (nhel(ihel, 61),ihel=1,8) / -1, -1,  1,  1,  1,  1, -1, -1/
    data (nhel(ihel, 62),ihel=1,8) / -1, -1,  1,  1,  1,  1, -1,  1/
    data (nhel(ihel, 63),ihel=1,8) / -1, -1,  1,  1,  1,  1,  1, -1/
    data (nhel(ihel, 64),ihel=1,8) / -1, -1,  1,  1,  1,  1,  1,  1/
    data (nhel(ihel, 65),ihel=1,8) / -1,  1, -1, -1, -1, -1, -1, -1/
    data (nhel(ihel, 66),ihel=1,8) / -1,  1, -1, -1, -1, -1, -1,  1/
    data (nhel(ihel, 67),ihel=1,8) / -1,  1, -1, -1, -1, -1,  1, -1/
    data (nhel(ihel, 68),ihel=1,8) / -1,  1, -1, -1, -1, -1,  1,  1/
    data (nhel(ihel, 69),ihel=1,8) / -1,  1, -1, -1, -1,  1, -1, -1/
    data (nhel(ihel, 70),ihel=1,8) / -1,  1, -1, -1, -1,  1, -1,  1/
    data (nhel(ihel, 71),ihel=1,8) / -1,  1, -1, -1, -1,  1,  1, -1/
    data (nhel(ihel, 72),ihel=1,8) / -1,  1, -1, -1, -1,  1,  1,  1/
    data (nhel(ihel, 73),ihel=1,8) / -1,  1, -1, -1,  1, -1, -1, -1/
    data (nhel(ihel, 74),ihel=1,8) / -1,  1, -1, -1,  1, -1, -1,  1/
    data (nhel(ihel, 75),ihel=1,8) / -1,  1, -1, -1,  1, -1,  1, -1/
    data (nhel(ihel, 76),ihel=1,8) / -1,  1, -1, -1,  1, -1,  1,  1/
    data (nhel(ihel, 77),ihel=1,8) / -1,  1, -1, -1,  1,  1, -1, -1/
    data (nhel(ihel, 78),ihel=1,8) / -1,  1, -1, -1,  1,  1, -1,  1/
    data (nhel(ihel, 79),ihel=1,8) / -1,  1, -1, -1,  1,  1,  1, -1/
    data (nhel(ihel, 80),ihel=1,8) / -1,  1, -1, -1,  1,  1,  1,  1/
    data (nhel(ihel, 81),ihel=1,8) / -1,  1, -1,  1, -1, -1, -1, -1/
    data (nhel(ihel, 82),ihel=1,8) / -1,  1, -1,  1, -1, -1, -1,  1/
    data (nhel(ihel, 83),ihel=1,8) / -1,  1, -1,  1, -1, -1,  1, -1/
    data (nhel(ihel, 84),ihel=1,8) / -1,  1, -1,  1, -1, -1,  1,  1/
    data (nhel(ihel, 85),ihel=1,8) / -1,  1, -1,  1, -1,  1, -1, -1/
    data (nhel(ihel, 86),ihel=1,8) / -1,  1, -1,  1, -1,  1, -1,  1/
    data (nhel(ihel, 87),ihel=1,8) / -1,  1, -1,  1, -1,  1,  1, -1/
    data (nhel(ihel, 88),ihel=1,8) / -1,  1, -1,  1, -1,  1,  1,  1/
    data (nhel(ihel, 89),ihel=1,8) / -1,  1, -1,  1,  1, -1, -1, -1/
    data (nhel(ihel, 90),ihel=1,8) / -1,  1, -1,  1,  1, -1, -1,  1/
    data (nhel(ihel, 91),ihel=1,8) / -1,  1, -1,  1,  1, -1,  1, -1/
    data (nhel(ihel, 92),ihel=1,8) / -1,  1, -1,  1,  1, -1,  1,  1/
    data (nhel(ihel, 93),ihel=1,8) / -1,  1, -1,  1,  1,  1, -1, -1/
    data (nhel(ihel, 94),ihel=1,8) / -1,  1, -1,  1,  1,  1, -1,  1/
    data (nhel(ihel, 95),ihel=1,8) / -1,  1, -1,  1,  1,  1,  1, -1/
    data (nhel(ihel, 96),ihel=1,8) / -1,  1, -1,  1,  1,  1,  1,  1/
    data (nhel(ihel, 97),ihel=1,8) / -1,  1,  1, -1, -1, -1, -1, -1/
    data (nhel(ihel, 98),ihel=1,8) / -1,  1,  1, -1, -1, -1, -1,  1/
    data (nhel(ihel, 99),ihel=1,8) / -1,  1,  1, -1, -1, -1,  1, -1/
    data (nhel(ihel,100),ihel=1,8) / -1,  1,  1, -1, -1, -1,  1,  1/
    data (nhel(ihel,101),ihel=1,8) / -1,  1,  1, -1, -1,  1, -1, -1/
    data (nhel(ihel,102),ihel=1,8) / -1,  1,  1, -1, -1,  1, -1,  1/
    data (nhel(ihel,103),ihel=1,8) / -1,  1,  1, -1, -1,  1,  1, -1/
    data (nhel(ihel,104),ihel=1,8) / -1,  1,  1, -1, -1,  1,  1,  1/
    data (nhel(ihel,105),ihel=1,8) / -1,  1,  1, -1,  1, -1, -1, -1/
    data (nhel(ihel,106),ihel=1,8) / -1,  1,  1, -1,  1, -1, -1,  1/
    data (nhel(ihel,107),ihel=1,8) / -1,  1,  1, -1,  1, -1,  1, -1/
    data (nhel(ihel,108),ihel=1,8) / -1,  1,  1, -1,  1, -1,  1,  1/
    data (nhel(ihel,109),ihel=1,8) / -1,  1,  1, -1,  1,  1, -1, -1/
    data (nhel(ihel,110),ihel=1,8) / -1,  1,  1, -1,  1,  1, -1,  1/
    data (nhel(ihel,111),ihel=1,8) / -1,  1,  1, -1,  1,  1,  1, -1/
    data (nhel(ihel,112),ihel=1,8) / -1,  1,  1, -1,  1,  1,  1,  1/
    data (nhel(ihel,113),ihel=1,8) / -1,  1,  1,  1, -1, -1, -1, -1/
    data (nhel(ihel,114),ihel=1,8) / -1,  1,  1,  1, -1, -1, -1,  1/
    data (nhel(ihel,115),ihel=1,8) / -1,  1,  1,  1, -1, -1,  1, -1/
    data (nhel(ihel,116),ihel=1,8) / -1,  1,  1,  1, -1, -1,  1,  1/
    data (nhel(ihel,117),ihel=1,8) / -1,  1,  1,  1, -1,  1, -1, -1/
    data (nhel(ihel,118),ihel=1,8) / -1,  1,  1,  1, -1,  1, -1,  1/
    data (nhel(ihel,119),ihel=1,8) / -1,  1,  1,  1, -1,  1,  1, -1/
    data (nhel(ihel,120),ihel=1,8) / -1,  1,  1,  1, -1,  1,  1,  1/
    data (nhel(ihel,121),ihel=1,8) / -1,  1,  1,  1,  1, -1, -1, -1/
    data (nhel(ihel,122),ihel=1,8) / -1,  1,  1,  1,  1, -1, -1,  1/
    data (nhel(ihel,123),ihel=1,8) / -1,  1,  1,  1,  1, -1,  1, -1/
    data (nhel(ihel,124),ihel=1,8) / -1,  1,  1,  1,  1, -1,  1,  1/
    data (nhel(ihel,125),ihel=1,8) / -1,  1,  1,  1,  1,  1, -1, -1/
    data (nhel(ihel,126),ihel=1,8) / -1,  1,  1,  1,  1,  1, -1,  1/
    data (nhel(ihel,127),ihel=1,8) / -1,  1,  1,  1,  1,  1,  1, -1/
    data (nhel(ihel,128),ihel=1,8) / -1,  1,  1,  1,  1,  1,  1,  1/
    data (nhel(ihel,129),ihel=1,8) /  1, -1, -1, -1, -1, -1, -1, -1/
    data (nhel(ihel,130),ihel=1,8) /  1, -1, -1, -1, -1, -1, -1,  1/
    data (nhel(ihel,131),ihel=1,8) /  1, -1, -1, -1, -1, -1,  1, -1/
    data (nhel(ihel,132),ihel=1,8) /  1, -1, -1, -1, -1, -1,  1,  1/
    data (nhel(ihel,133),ihel=1,8) /  1, -1, -1, -1, -1,  1, -1, -1/
    data (nhel(ihel,134),ihel=1,8) /  1, -1, -1, -1, -1,  1, -1,  1/
    data (nhel(ihel,135),ihel=1,8) /  1, -1, -1, -1, -1,  1,  1, -1/
    data (nhel(ihel,136),ihel=1,8) /  1, -1, -1, -1, -1,  1,  1,  1/
    data (nhel(ihel,137),ihel=1,8) /  1, -1, -1, -1,  1, -1, -1, -1/
    data (nhel(ihel,138),ihel=1,8) /  1, -1, -1, -1,  1, -1, -1,  1/
    data (nhel(ihel,139),ihel=1,8) /  1, -1, -1, -1,  1, -1,  1, -1/
    data (nhel(ihel,140),ihel=1,8) /  1, -1, -1, -1,  1, -1,  1,  1/
    data (nhel(ihel,141),ihel=1,8) /  1, -1, -1, -1,  1,  1, -1, -1/
    data (nhel(ihel,142),ihel=1,8) /  1, -1, -1, -1,  1,  1, -1,  1/
    data (nhel(ihel,143),ihel=1,8) /  1, -1, -1, -1,  1,  1,  1, -1/
    data (nhel(ihel,144),ihel=1,8) /  1, -1, -1, -1,  1,  1,  1,  1/
    data (nhel(ihel,145),ihel=1,8) /  1, -1, -1,  1, -1, -1, -1, -1/
    data (nhel(ihel,146),ihel=1,8) /  1, -1, -1,  1, -1, -1, -1,  1/
    data (nhel(ihel,147),ihel=1,8) /  1, -1, -1,  1, -1, -1,  1, -1/
    data (nhel(ihel,148),ihel=1,8) /  1, -1, -1,  1, -1, -1,  1,  1/
    data (nhel(ihel,149),ihel=1,8) /  1, -1, -1,  1, -1,  1, -1, -1/
    data (nhel(ihel,150),ihel=1,8) /  1, -1, -1,  1, -1,  1, -1,  1/
    data (nhel(ihel,151),ihel=1,8) /  1, -1, -1,  1, -1,  1,  1, -1/
    data (nhel(ihel,152),ihel=1,8) /  1, -1, -1,  1, -1,  1,  1,  1/
    data (nhel(ihel,153),ihel=1,8) /  1, -1, -1,  1,  1, -1, -1, -1/
    data (nhel(ihel,154),ihel=1,8) /  1, -1, -1,  1,  1, -1, -1,  1/
    data (nhel(ihel,155),ihel=1,8) /  1, -1, -1,  1,  1, -1,  1, -1/
    data (nhel(ihel,156),ihel=1,8) /  1, -1, -1,  1,  1, -1,  1,  1/
    data (nhel(ihel,157),ihel=1,8) /  1, -1, -1,  1,  1,  1, -1, -1/
    data (nhel(ihel,158),ihel=1,8) /  1, -1, -1,  1,  1,  1, -1,  1/
    data (nhel(ihel,159),ihel=1,8) /  1, -1, -1,  1,  1,  1,  1, -1/
    data (nhel(ihel,160),ihel=1,8) /  1, -1, -1,  1,  1,  1,  1,  1/
    data (nhel(ihel,161),ihel=1,8) /  1, -1,  1, -1, -1, -1, -1, -1/
    data (nhel(ihel,162),ihel=1,8) /  1, -1,  1, -1, -1, -1, -1,  1/
    data (nhel(ihel,163),ihel=1,8) /  1, -1,  1, -1, -1, -1,  1, -1/
    data (nhel(ihel,164),ihel=1,8) /  1, -1,  1, -1, -1, -1,  1,  1/
    data (nhel(ihel,165),ihel=1,8) /  1, -1,  1, -1, -1,  1, -1, -1/
    data (nhel(ihel,166),ihel=1,8) /  1, -1,  1, -1, -1,  1, -1,  1/
    data (nhel(ihel,167),ihel=1,8) /  1, -1,  1, -1, -1,  1,  1, -1/
    data (nhel(ihel,168),ihel=1,8) /  1, -1,  1, -1, -1,  1,  1,  1/
    data (nhel(ihel,169),ihel=1,8) /  1, -1,  1, -1,  1, -1, -1, -1/
    data (nhel(ihel,170),ihel=1,8) /  1, -1,  1, -1,  1, -1, -1,  1/
    data (nhel(ihel,171),ihel=1,8) /  1, -1,  1, -1,  1, -1,  1, -1/
    data (nhel(ihel,172),ihel=1,8) /  1, -1,  1, -1,  1, -1,  1,  1/
    data (nhel(ihel,173),ihel=1,8) /  1, -1,  1, -1,  1,  1, -1, -1/
    data (nhel(ihel,174),ihel=1,8) /  1, -1,  1, -1,  1,  1, -1,  1/
    data (nhel(ihel,175),ihel=1,8) /  1, -1,  1, -1,  1,  1,  1, -1/
    data (nhel(ihel,176),ihel=1,8) /  1, -1,  1, -1,  1,  1,  1,  1/
    data (nhel(ihel,177),ihel=1,8) /  1, -1,  1,  1, -1, -1, -1, -1/
    data (nhel(ihel,178),ihel=1,8) /  1, -1,  1,  1, -1, -1, -1,  1/
    data (nhel(ihel,179),ihel=1,8) /  1, -1,  1,  1, -1, -1,  1, -1/
    data (nhel(ihel,180),ihel=1,8) /  1, -1,  1,  1, -1, -1,  1,  1/
    data (nhel(ihel,181),ihel=1,8) /  1, -1,  1,  1, -1,  1, -1, -1/
    data (nhel(ihel,182),ihel=1,8) /  1, -1,  1,  1, -1,  1, -1,  1/
    data (nhel(ihel,183),ihel=1,8) /  1, -1,  1,  1, -1,  1,  1, -1/
    data (nhel(ihel,184),ihel=1,8) /  1, -1,  1,  1, -1,  1,  1,  1/
    data (nhel(ihel,185),ihel=1,8) /  1, -1,  1,  1,  1, -1, -1, -1/
    data (nhel(ihel,186),ihel=1,8) /  1, -1,  1,  1,  1, -1, -1,  1/
    data (nhel(ihel,187),ihel=1,8) /  1, -1,  1,  1,  1, -1,  1, -1/
    data (nhel(ihel,188),ihel=1,8) /  1, -1,  1,  1,  1, -1,  1,  1/
    data (nhel(ihel,189),ihel=1,8) /  1, -1,  1,  1,  1,  1, -1, -1/
    data (nhel(ihel,190),ihel=1,8) /  1, -1,  1,  1,  1,  1, -1,  1/
    data (nhel(ihel,191),ihel=1,8) /  1, -1,  1,  1,  1,  1,  1, -1/
    data (nhel(ihel,192),ihel=1,8) /  1, -1,  1,  1,  1,  1,  1,  1/
    data (nhel(ihel,193),ihel=1,8) /  1,  1, -1, -1, -1, -1, -1, -1/
    data (nhel(ihel,194),ihel=1,8) /  1,  1, -1, -1, -1, -1, -1,  1/
    data (nhel(ihel,195),ihel=1,8) /  1,  1, -1, -1, -1, -1,  1, -1/
    data (nhel(ihel,196),ihel=1,8) /  1,  1, -1, -1, -1, -1,  1,  1/
    data (nhel(ihel,197),ihel=1,8) /  1,  1, -1, -1, -1,  1, -1, -1/
    data (nhel(ihel,198),ihel=1,8) /  1,  1, -1, -1, -1,  1, -1,  1/
    data (nhel(ihel,199),ihel=1,8) /  1,  1, -1, -1, -1,  1,  1, -1/
    data (nhel(ihel,200),ihel=1,8) /  1,  1, -1, -1, -1,  1,  1,  1/
    data (nhel(ihel,201),ihel=1,8) /  1,  1, -1, -1,  1, -1, -1, -1/
    data (nhel(ihel,202),ihel=1,8) /  1,  1, -1, -1,  1, -1, -1,  1/
    data (nhel(ihel,203),ihel=1,8) /  1,  1, -1, -1,  1, -1,  1, -1/
    data (nhel(ihel,204),ihel=1,8) /  1,  1, -1, -1,  1, -1,  1,  1/
    data (nhel(ihel,205),ihel=1,8) /  1,  1, -1, -1,  1,  1, -1, -1/
    data (nhel(ihel,206),ihel=1,8) /  1,  1, -1, -1,  1,  1, -1,  1/
    data (nhel(ihel,207),ihel=1,8) /  1,  1, -1, -1,  1,  1,  1, -1/
    data (nhel(ihel,208),ihel=1,8) /  1,  1, -1, -1,  1,  1,  1,  1/
    data (nhel(ihel,209),ihel=1,8) /  1,  1, -1,  1, -1, -1, -1, -1/
    data (nhel(ihel,210),ihel=1,8) /  1,  1, -1,  1, -1, -1, -1,  1/
    data (nhel(ihel,211),ihel=1,8) /  1,  1, -1,  1, -1, -1,  1, -1/
    data (nhel(ihel,212),ihel=1,8) /  1,  1, -1,  1, -1, -1,  1,  1/
    data (nhel(ihel,213),ihel=1,8) /  1,  1, -1,  1, -1,  1, -1, -1/
    data (nhel(ihel,214),ihel=1,8) /  1,  1, -1,  1, -1,  1, -1,  1/
    data (nhel(ihel,215),ihel=1,8) /  1,  1, -1,  1, -1,  1,  1, -1/
    data (nhel(ihel,216),ihel=1,8) /  1,  1, -1,  1, -1,  1,  1,  1/
    data (nhel(ihel,217),ihel=1,8) /  1,  1, -1,  1,  1, -1, -1, -1/
    data (nhel(ihel,218),ihel=1,8) /  1,  1, -1,  1,  1, -1, -1,  1/
    data (nhel(ihel,219),ihel=1,8) /  1,  1, -1,  1,  1, -1,  1, -1/
    data (nhel(ihel,220),ihel=1,8) /  1,  1, -1,  1,  1, -1,  1,  1/
    data (nhel(ihel,221),ihel=1,8) /  1,  1, -1,  1,  1,  1, -1, -1/
    data (nhel(ihel,222),ihel=1,8) /  1,  1, -1,  1,  1,  1, -1,  1/
    data (nhel(ihel,223),ihel=1,8) /  1,  1, -1,  1,  1,  1,  1, -1/
    data (nhel(ihel,224),ihel=1,8) /  1,  1, -1,  1,  1,  1,  1,  1/
    data (nhel(ihel,225),ihel=1,8) /  1,  1,  1, -1, -1, -1, -1, -1/
    data (nhel(ihel,226),ihel=1,8) /  1,  1,  1, -1, -1, -1, -1,  1/
    data (nhel(ihel,227),ihel=1,8) /  1,  1,  1, -1, -1, -1,  1, -1/
    data (nhel(ihel,228),ihel=1,8) /  1,  1,  1, -1, -1, -1,  1,  1/
    data (nhel(ihel,229),ihel=1,8) /  1,  1,  1, -1, -1,  1, -1, -1/
    data (nhel(ihel,230),ihel=1,8) /  1,  1,  1, -1, -1,  1, -1,  1/
    data (nhel(ihel,231),ihel=1,8) /  1,  1,  1, -1, -1,  1,  1, -1/
    data (nhel(ihel,232),ihel=1,8) /  1,  1,  1, -1, -1,  1,  1,  1/
    data (nhel(ihel,233),ihel=1,8) /  1,  1,  1, -1,  1, -1, -1, -1/
    data (nhel(ihel,234),ihel=1,8) /  1,  1,  1, -1,  1, -1, -1,  1/
    data (nhel(ihel,235),ihel=1,8) /  1,  1,  1, -1,  1, -1,  1, -1/
    data (nhel(ihel,236),ihel=1,8) /  1,  1,  1, -1,  1, -1,  1,  1/
    data (nhel(ihel,237),ihel=1,8) /  1,  1,  1, -1,  1,  1, -1, -1/
    data (nhel(ihel,238),ihel=1,8) /  1,  1,  1, -1,  1,  1, -1,  1/
    data (nhel(ihel,239),ihel=1,8) /  1,  1,  1, -1,  1,  1,  1, -1/
    data (nhel(ihel,240),ihel=1,8) /  1,  1,  1, -1,  1,  1,  1,  1/
    data (nhel(ihel,241),ihel=1,8) /  1,  1,  1,  1, -1, -1, -1, -1/
    data (nhel(ihel,242),ihel=1,8) /  1,  1,  1,  1, -1, -1, -1,  1/
    data (nhel(ihel,243),ihel=1,8) /  1,  1,  1,  1, -1, -1,  1, -1/
    data (nhel(ihel,244),ihel=1,8) /  1,  1,  1,  1, -1, -1,  1,  1/
    data (nhel(ihel,245),ihel=1,8) /  1,  1,  1,  1, -1,  1, -1, -1/
    data (nhel(ihel,246),ihel=1,8) /  1,  1,  1,  1, -1,  1, -1,  1/
    data (nhel(ihel,247),ihel=1,8) /  1,  1,  1,  1, -1,  1,  1, -1/
    data (nhel(ihel,248),ihel=1,8) /  1,  1,  1,  1, -1,  1,  1,  1/
    data (nhel(ihel,249),ihel=1,8) /  1,  1,  1,  1,  1, -1, -1, -1/
    data (nhel(ihel,250),ihel=1,8) /  1,  1,  1,  1,  1, -1, -1,  1/
    data (nhel(ihel,251),ihel=1,8) /  1,  1,  1,  1,  1, -1,  1, -1/
    data (nhel(ihel,252),ihel=1,8) /  1,  1,  1,  1,  1, -1,  1,  1/
    data (nhel(ihel,253),ihel=1,8) /  1,  1,  1,  1,  1,  1, -1, -1/
    data (nhel(ihel,254),ihel=1,8) /  1,  1,  1,  1,  1,  1, -1,  1/
    data (nhel(ihel,255),ihel=1,8) /  1,  1,  1,  1,  1,  1,  1, -1/
    data (nhel(ihel,256),ihel=1,8) /  1,  1,  1,  1,  1,  1,  1,  1/
    ! ----------
    ! begin code
    ! ----------
    sgg_bbemuvevm = 0d0
    ntry = ntry + 1
    do ihel = 1, ncomb
        if (goodhel(ihel) .or. ntry < 10) then
            t = gg_bbemuvevm(p1, p2, p3, p4, p5, p6, p7, p8, nhel(1, ihel))
            sgg_bbemuvevm = sgg_bbemuvevm + t
            if (t > 0d0 .and. .not. goodhel(ihel)) then
                goodhel(ihel) = .true.
                ! write(*,*) ihel,t
            endif
        endif
    enddo
    sgg_bbemuvevm = sgg_bbemuvevm/4d0
end function sgg_bbemuvevm


function gg_bbemuvevm(p1, p2, p3, p4, p5, p6, p7, p8, nhel)

    ! function generated by madgraph
    ! returns amplitude squared summed/avg over colors
    ! for the point in phase space p1, p2, p3, p4,...
    ! and helicity nhel(1), nhel(2),....

    ! for process : g g  -> b b~ mu+ e- ve~ vm

    use modelling
    use configuration, only: include_signal, include_background

    implicit none

    real*8 :: gg_bbemuvevm

    ! constants
    integer, parameter :: ngraphs = 103, neigen = 2, nexternal = 8
    real*8, parameter :: zero = 0d0

    ! arguments
    real*8 :: p1(0:3),p2(0:3),p3(0:3),p4(0:3),p5(0:3),p6(0:3),p7(0:3),p8(0:3)
    integer :: nhel(nexternal)

    ! local variables
    integer :: i, j
    real*8 :: eigen_val(neigen), eigen_vec(ngraphs, neigen)
    complex*16 ztemp
    complex*16 amp(ngraphs)
    complex*16 w1(6),  w2(6),  w3(6),  w4(6),  w5(6)
    complex*16 w6(6),  w7(6),  w8(6),  w9(6),  w10(6)
    complex*16 w11(6),  w12(6),  w13(6),  w14(6),  w15(6)
    complex*16 w16(6),  w17(6),  w18(6),  w19(6),  w20(6)
    complex*16 w21(6),  w22(6),  w23(6),  w24(6),  w25(6)
    complex*16 w26(6),  w27(6),  w28(6),  w29(6),  w30(6)
    complex*16 w31(6),  w32(6),  w33(6),  w34(6),  w35(6)
    complex*16 w36(6),  w37(6),  w38(6),  w39(6),  w40(6)
    complex*16 w41(6),  w42(6),  w43(6),  w44(6),  w45(6)
    complex*16 w46(6),  w47(6),  w48(6),  w49(6),  w50(6)
    complex*16 w51(6),  w52(6),  w53(6),  w54(6),  w55(6)
    complex*16 w56(6),  w57(6),  w58(6),  w59(6),  w60(6)
    complex*16 w61(6),  w62(6),  w63(6),  w64(6),  w65(6)
    complex*16 w66(6),  w67(6),  w68(6),  w69(6),  w70(6)
    complex*16 w71(6),  w72(6),  w73(6),  w74(6),  w75(6)
    complex*16 w76(6),  w77(6),  w78(6),  w79(6),  w80(6)
    complex*16 w81(6),  w82(6),  w83(6),  w84(6),  w85(6)
    complex*16 w86(6),  w87(6),  w88(6),  w89(6),  w90(6)
    complex*16 w91(6),  w92(6),  w93(6),  w94(6),  w95(6)
    complex*16 w96(6),  w97(6),  w98(6),  w99(6),  w100(6)
    complex*16 w101(6), w102(6), w103(6), w104(6), w105(6)
    complex*16 w106(6), w107(6), w108(6), w109(6), w110(6)
    complex*16 w111(6), w112(6), w113(6), w114(6), w115(6)
    complex*16 w116(6), w117(6), w118(6), w119(6), w120(6)
    complex*16 w121(6), w122(6), w123(6)

    ! color data
    data eigen_val(1)/       2.8437499999999982e+00 /
    data eigen_vec(1, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(2, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(3, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(4, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(5, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(6, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(7, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(8, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(9, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(10, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(11, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(12, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(13, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(14, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(15, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(16, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(17, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(18, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(19, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(20, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(21, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(22, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(23, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(24, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(25, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(26, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(27, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(28, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(29, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(30, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(31, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(32, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(33, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(34, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(35, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(36, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(37, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(38, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(39, 1)/  -1.1322770341445958e-01 /
    data eigen_vec(40, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(41, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(42, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(43, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(44, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(45, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(46, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(47, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(48, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(49, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(50, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(51, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(52, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(53, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(54, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(55, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(56, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(57, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(58, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(59, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(60, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(61, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(62, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(63, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(64, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(65, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(66, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(67, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(68, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(69, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(70, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(71, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(72, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(73, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(74, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(75, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(76, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(77, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(78, 1)/  -1.1322770341445956e-01 /
    data eigen_vec(79, 1)/   0.0000000000000000e+00 /
    data eigen_vec(80, 1)/   0.0000000000000000e+00 /
    data eigen_vec(81, 1)/   0.0000000000000000e+00 /
    data eigen_vec(82, 1)/   0.0000000000000000e+00 /
    data eigen_vec(83, 1)/   0.0000000000000000e+00 /
    data eigen_vec(84, 1)/   0.0000000000000000e+00 /
    data eigen_vec(85, 1)/   0.0000000000000000e+00 /
    data eigen_vec(86, 1)/   0.0000000000000000e+00 /
    data eigen_vec(87, 1)/   0.0000000000000000e+00 /
    data eigen_vec(88, 1)/   0.0000000000000000e+00 /
    data eigen_vec(89, 1)/   0.0000000000000000e+00 /
    data eigen_vec(90, 1)/   0.0000000000000000e+00 /
    data eigen_vec(91, 1)/   0.0000000000000000e+00 /
    data eigen_vec(92, 1)/   0.0000000000000000e+00 /
    data eigen_vec(93, 1)/   0.0000000000000000e+00 /
    data eigen_vec(94, 1)/   0.0000000000000000e+00 /
    data eigen_vec(95, 1)/   0.0000000000000000e+00 /
    data eigen_vec(96, 1)/   0.0000000000000000e+00 /
    data eigen_vec(97, 1)/   0.0000000000000000e+00 /
    data eigen_vec(98, 1)/   0.0000000000000000e+00 /
    data eigen_vec(99, 1)/   0.0000000000000000e+00 /
    data eigen_vec(100,1)/   0.0000000000000000e+00 /
    data eigen_vec(101,1)/   0.0000000000000000e+00 /
    data eigen_vec(102,1)/   0.0000000000000000e+00 /
    data eigen_vec(103,1)/   0.0000000000000000e+00 /
    data eigen_val(2)/       8.3437500000000036e+00 /
    data eigen_vec(1, 2)/   7.4953168899586142e-02 /
    data eigen_vec(2, 2)/   7.4953168899586142e-02 /
    data eigen_vec(3, 2)/   7.4953168899586142e-02 /
    data eigen_vec(4, 2)/   7.4953168899586142e-02 /
    data eigen_vec(5, 2)/   7.4953168899586142e-02 /
    data eigen_vec(6, 2)/   7.4953168899586142e-02 /
    data eigen_vec(7, 2)/   7.4953168899586142e-02 /
    data eigen_vec(8, 2)/   7.4953168899586142e-02 /
    data eigen_vec(9, 2)/   7.4953168899586142e-02 /
    data eigen_vec(10, 2)/   7.4953168899586142e-02 /
    data eigen_vec(11, 2)/   7.4953168899586142e-02 /
    data eigen_vec(12, 2)/   7.4953168899586142e-02 /
    data eigen_vec(13, 2)/   7.4953168899586142e-02 /
    data eigen_vec(14, 2)/   7.4953168899586142e-02 /
    data eigen_vec(15, 2)/   7.4953168899586142e-02 /
    data eigen_vec(16, 2)/   7.4953168899586142e-02 /
    data eigen_vec(17, 2)/   7.4953168899586142e-02 /
    data eigen_vec(18, 2)/   7.4953168899586142e-02 /
    data eigen_vec(19, 2)/   7.4953168899586142e-02 /
    data eigen_vec(20, 2)/   7.4953168899586142e-02 /
    data eigen_vec(21, 2)/   7.4953168899586142e-02 /
    data eigen_vec(22, 2)/   7.4953168899586142e-02 /
    data eigen_vec(23, 2)/   7.4953168899586142e-02 /
    data eigen_vec(24, 2)/   7.4953168899586142e-02 /
    data eigen_vec(25, 2)/   7.4953168899586142e-02 /
    data eigen_vec(26, 2)/   7.4953168899586142e-02 /
    data eigen_vec(27, 2)/   7.4953168899586142e-02 /
    data eigen_vec(28, 2)/   7.4953168899586142e-02 /
    data eigen_vec(29, 2)/   7.4953168899586142e-02 /
    data eigen_vec(30, 2)/   7.4953168899586142e-02 /
    data eigen_vec(31, 2)/   7.4953168899586142e-02 /
    data eigen_vec(32, 2)/   7.4953168899586142e-02 /
    data eigen_vec(33, 2)/   7.4953168899586142e-02 /
    data eigen_vec(34, 2)/   7.4953168899586142e-02 /
    data eigen_vec(35, 2)/   7.4953168899586142e-02 /
    data eigen_vec(36, 2)/   7.4953168899586142e-02 /
    data eigen_vec(37, 2)/   7.4953168899586142e-02 /
    data eigen_vec(38, 2)/   7.4953168899586142e-02 /
    data eigen_vec(39, 2)/   7.4953168899586142e-02 /
    data eigen_vec(40, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(41, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(42, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(43, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(44, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(45, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(46, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(47, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(48, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(49, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(50, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(51, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(52, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(53, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(54, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(55, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(56, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(57, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(58, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(59, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(60, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(61, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(62, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(63, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(64, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(65, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(66, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(67, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(68, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(69, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(70, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(71, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(72, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(73, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(74, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(75, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(76, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(77, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(78, 2)/  -7.4953168899586115e-02 /
    data eigen_vec(79, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(80, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(81, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(82, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(83, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(84, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(85, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(86, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(87, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(88, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(89, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(90, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(91, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(92, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(93, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(94, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(95, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(96, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(97, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(98, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(99, 2)/  -1.4990633779917226e-01 /
    data eigen_vec(100,2)/  -1.4990633779917226e-01 /
    data eigen_vec(101,2)/  -1.4990633779917226e-01 /
    data eigen_vec(102,2)/  -1.4990633779917226e-01 /
    data eigen_vec(103,2)/  -1.4990633779917226e-01 /

    ! ----------
    ! begin code
    ! ----------

    ! initalise amps
    do j = 1, ngraphs
        amp(j) = 0.d0
    end do

    ! external particles
    call ixxxxx(p1, fmass(3), nhel(1), 1, w1)
    call oxxxxx(p2, fmass(3), nhel(2), -1, w2)
    call oxxxxx(p3, fmass(12), nhel(3), 1, w3)
    call ixxxxx(p4, fmass(12), nhel(4), -1, w4)
    call ixxxxx(p5, fmass(1), nhel(5), -1, w5)
    call oxxxxx(p6, fmass(5), nhel(6), 1, w6)
    call oxxxxx(p7, fmass(2), nhel(7), 1, w7)
    call ixxxxx(p8, fmass(6), nhel(8), -1, w8)

    ! currents
    call jioxxx(w7, w6, gwf, wmass, wwidth, w9)
    call jioxxx(w5, w8, gwf, wmass, wwidth, w10)
    call fvoxxx(w3, w10, gwf, fmass(11), fwidth(11), w11)
    call fvixxx(w4, w9, gwf, fmass(11), fwidth(11), w12)
    call fvoxxx(w11, w2, gg, fmass(11), fwidth(11), w13)
    call fvoxxx(w11, w1, gg, fmass(11), fwidth(11), w55)
    call jggxxx(w1, w2, g, w94)

    if (include_background) then
        call fvixxx(w4, w1, gg, fmass(12), fwidth(12), w14)
        call fvixxx(w14, w2, gg, fmass(12), fwidth(12), w15)
        call jioxxx(w15, w3, gad,amass,awidth, w16)
        call fvoxxx(w6, w16, gal, fmass(1), fwidth(1), w17)
        call jioxxx(w15, w3, gzd,zmass,zwidth, w18)
        call fvoxxx(w6, w18, gzl, fmass(1), fwidth(1), w19)
        call hioxxx(w15, w3, gchf(1,12),hmass,hwidth, w20)
        call fvixxx(w5, w9, gwf, fmass(6), fwidth(6), w21)
        call fvoxxx(w8, w9, gwf, fmass(5), fwidth(5), w22)
        call fvoxxx(w6, w10, gwf, fmass(2), fwidth(2), w23)
        call fvixxx(w14, w9, gwf, fmass(11), fwidth(11), w24)
        call fvoxxx(w3, w2, gg, fmass(12), fwidth(12), w25)
        call fvoxxx(w25, w1, gg, fmass(12), fwidth(12), w26)
        call fvoxxx(w26, w10, gwf, fmass(11), fwidth(11), w27)
        call jioxxx(w4, w26, gad,amass,awidth, w28)
        call fvoxxx(w6, w28, gal, fmass(1), fwidth(1), w29)
        call jioxxx(w7, w29, gwf, wmass, wwidth, w30)
        call jioxxx(w4, w26, gzd,zmass,zwidth, w31)
        call fvoxxx(w6, w31, gzl, fmass(1), fwidth(1), w32)
        call jioxxx(w7, w32, gwf, wmass, wwidth, w33)
        call hioxxx(w4, w26, gchf(1,12),hmass,hwidth, w34)
        call fvoxxx(w8, w31, gzn, fmass(6), fwidth(6), w35)
        call fsoxxx(w8, w34, gchf(1,6), fmass(6), fwidth(6), w36)
        call fvixxx(w5, w28, gal, fmass(5), fwidth(5), w37)
        call fvixxx(w5, w31, gzl, fmass(5), fwidth(5), w38)
        call fsixxx(w5, w34, gchf(1,5), fmass(5), fwidth(5), w39)
        call fvixxx(w7, w31, gzn, fmass(2), fwidth(2), w40)
        call fvoxxx(w25, w10, gwf, fmass(11), fwidth(11), w41)
        call jioxxx(w14, w25, gad,amass,awidth, w42)
        call fvoxxx(w6, w42, gal, fmass(1), fwidth(1), w43)
        call jioxxx(w7, w43, gwf, wmass, wwidth, w44)
        call jioxxx(w14, w25, gzd,zmass,zwidth, w45)
        call fvoxxx(w6, w45, gzl, fmass(1), fwidth(1), w46)
        call jioxxx(w7, w46, gwf, wmass, wwidth, w47)
        call hioxxx(w14, w25, gchf(1,12),hmass,hwidth, w48)
        call fvoxxx(w8, w45, gzn, fmass(6), fwidth(6), w49)
        call fsoxxx(w8, w48, gchf(1,6), fmass(6), fwidth(6), w50)
        call fvixxx(w5, w42, gal, fmass(5), fwidth(5), w51)
        call fvixxx(w5, w45, gzl, fmass(5), fwidth(5), w52)
        call fsixxx(w5, w48, gchf(1,5), fmass(5), fwidth(5), w53)
        call fvixxx(w7, w45, gzn, fmass(2), fwidth(2), w54)
        call fvixxx(w4, w2, gg, fmass(12), fwidth(12), w56)
        call fvixxx(w56, w1, gg, fmass(12), fwidth(12), w57)
        call jioxxx(w57, w3, gad,amass,awidth, w58)
        call fvoxxx(w6, w58, gal, fmass(1), fwidth(1), w59)
        call jioxxx(w57, w3, gzd,zmass,zwidth, w60)
        call fvoxxx(w6, w60, gzl, fmass(1), fwidth(1), w61)
        call hioxxx(w57, w3, gchf(1,12),hmass,hwidth, w62)
        call fvixxx(w56, w9, gwf, fmass(11), fwidth(11), w63)
        call fvoxxx(w3, w1, gg, fmass(12), fwidth(12), w64)
        call fvoxxx(w64, w2, gg, fmass(12), fwidth(12), w65)
        call fvoxxx(w65, w10, gwf, fmass(11), fwidth(11), w66)
        call jioxxx(w4, w65, gad,amass,awidth, w67)
        call fvoxxx(w6, w67, gal, fmass(1), fwidth(1), w68)
        call jioxxx(w7, w68, gwf, wmass, wwidth, w69)
        call jioxxx(w4, w65, gzd,zmass,zwidth, w70)
        call fvoxxx(w6, w70, gzl, fmass(1), fwidth(1), w71)
        call jioxxx(w7, w71, gwf, wmass, wwidth, w72)
        call hioxxx(w4, w65, gchf(1,12),hmass,hwidth, w73)
        call fvoxxx(w8, w70, gzn, fmass(6), fwidth(6), w74)
        call fsoxxx(w8, w73, gchf(1,6), fmass(6), fwidth(6), w75)
        call fvixxx(w5, w67, gal, fmass(5), fwidth(5), w76)
        call fvixxx(w5, w70, gzl, fmass(5), fwidth(5), w77)
        call fsixxx(w5, w73, gchf(1,5), fmass(5), fwidth(5), w78)
        call fvixxx(w7, w70, gzn, fmass(2), fwidth(2), w79)
        call fvoxxx(w64, w10, gwf, fmass(11), fwidth(11), w80)
        call jioxxx(w56, w64, gad,amass,awidth, w81)
        call fvoxxx(w6, w81, gal, fmass(1), fwidth(1), w82)
        call jioxxx(w7, w82, gwf, wmass, wwidth, w83)
        call jioxxx(w56, w64, gzd,zmass,zwidth, w84)
        call fvoxxx(w6, w84, gzl, fmass(1), fwidth(1), w85)
        call jioxxx(w7, w85, gwf, wmass, wwidth, w86)
        call hioxxx(w56, w64, gchf(1,12),hmass,hwidth, w87)
        call fvoxxx(w8, w84, gzn, fmass(6), fwidth(6), w88)
        call fsoxxx(w8, w87, gchf(1,6), fmass(6), fwidth(6), w89)
        call fvixxx(w5, w81, gal, fmass(5), fwidth(5), w90)
        call fvixxx(w5, w84, gzl, fmass(5), fwidth(5), w91)
        call fsixxx(w5, w87, gchf(1,5), fmass(5), fwidth(5), w92)
        call fvixxx(w7, w84, gzn, fmass(2), fwidth(2), w93)
        call fvixxx(w4, w94, gg, fmass(12), fwidth(12), w95)
        call jioxxx(w95, w3, gad,amass,awidth, w96)
        call fvoxxx(w6, w96, gal, fmass(1), fwidth(1), w97)
        call jioxxx(w7, w97, gwf, wmass, wwidth, w98)
        call jioxxx(w95, w3, gzd,zmass,zwidth, w99)
        call fvoxxx(w6, w99, gzl, fmass(1), fwidth(1), w100)
        call jioxxx(w7, w100,gwf, wmass, wwidth, w101)
        call hioxxx(w95, w3, gchf(1,12),hmass,hwidth, w102)
        call fvoxxx(w8, w99, gzn, fmass(6), fwidth(6), w103)
        call fsoxxx(w8, w102,gchf(1,6), fmass(6), fwidth(6), w104)
        call fvixxx(w5, w96, gal, fmass(5), fwidth(5), w105)
        call fvixxx(w5, w99, gzl, fmass(5), fwidth(5), w106)
        call fsixxx(w5, w102,gchf(1,5), fmass(5), fwidth(5), w107)
        call fvixxx(w7, w99, gzn, fmass(2), fwidth(2), w108)
        call fvoxxx(w3, w94, gg, fmass(12), fwidth(12), w109)
        call fvoxxx(w109, w10, gwf, fmass(11), fwidth(11), w110)
        call jioxxx(w4, w109,gad,amass,awidth, w111)
        call fvoxxx(w6, w111,gal, fmass(1), fwidth(1), w112)
        call jioxxx(w7, w112,gwf, wmass, wwidth, w113)
        call jioxxx(w4, w109,gzd,zmass,zwidth, w114)
        call fvoxxx(w6, w114,gzl, fmass(1), fwidth(1), w115)
        call jioxxx(w7, w115,gwf, wmass, wwidth, w116)
        call hioxxx(w4, w109,gchf(1,12),hmass,hwidth, w117)
        call fvoxxx(w8, w114,gzn, fmass(6), fwidth(6), w118)
        call fsoxxx(w8, w117,gchf(1,6), fmass(6), fwidth(6), w119)
        call fvixxx(w5, w111,gal, fmass(5), fwidth(5), w120)
        call fvixxx(w5, w114,gzl, fmass(5), fwidth(5), w121)
        call fsixxx(w5, w117,gchf(1,5), fmass(5), fwidth(5), w122)
        call fvixxx(w7, w114,gzn, fmass(2), fwidth(2), w123)
    end if

    ! amplitudes
    if (include_signal) then
        call iovxxx(w12, w13, w1, gg, amp(1))
        call iovxxx(w12, w55, w2, gg, amp(40))
        call iovxxx(w12, w11, w94, gg, amp(79))
    end if

    if (include_background) then
        call iovxxx(w7, w17, w10, gwf, amp(2))
        call iovxxx(w7, w19, w10, gwf, amp(3))
        call vvvxxx(w9, w10, w16, gwwa, amp(4))
        call vvvxxx(w9, w10, w18, gwwz, amp(5))
        call vvsxxx(w9, w10, w20, gwwh, amp(6))
        call iovxxx(w21, w8, w18, gzn, amp(7))
        call iosxxx(w21, w8, w20, gchf(1,6), amp(8))
        call iovxxx(w5, w22, w16, gal, amp(9))
        call iovxxx(w5, w22, w18, gzl, amp(10))
        call iosxxx(w5, w22, w20, gchf(1,5), amp(11))
        call iovxxx(w7, w23, w18, gzn, amp(12))
        call iovxxx(w24, w11, w2, gg, amp(13))
        call iovxxx(w15, w11, w9, gwf, amp(14))
        call iovxxx(w4, w27, w9, gwf, amp(15))
        call iovxxx(w5, w8, w30, gwf, amp(16))
        call iovxxx(w5, w8, w33, gwf, amp(17))
        call vvvxxx(w9, w10, w28, gwwa, amp(18))
        call vvvxxx(w9, w10, w31, gwwz, amp(19))
        call vvsxxx(w9, w10, w34, gwwh, amp(20))
        call iovxxx(w5, w35, w9, gwf, amp(21))
        call iovxxx(w5, w36, w9, gwf, amp(22))
        call iovxxx(w37, w8, w9, gwf, amp(23))
        call iovxxx(w38, w8, w9, gwf, amp(24))
        call iovxxx(w39, w8, w9, gwf, amp(25))
        call iovxxx(w40, w6, w10, gwf, amp(26))
        call iovxxx(w12, w41, w1, gg, amp(27))
        call iovxxx(w5, w8, w44, gwf, amp(28))
        call iovxxx(w5, w8, w47, gwf, amp(29))
        call vvvxxx(w9, w10, w42, gwwa, amp(30))
        call vvvxxx(w9, w10, w45, gwwz, amp(31))
        call vvsxxx(w9, w10, w48, gwwh, amp(32))
        call iovxxx(w5, w49, w9, gwf, amp(33))
        call iovxxx(w5, w50, w9, gwf, amp(34))
        call iovxxx(w51, w8, w9, gwf, amp(35))
        call iovxxx(w52, w8, w9, gwf, amp(36))
        call iovxxx(w53, w8, w9, gwf, amp(37))
        call iovxxx(w54, w6, w10, gwf, amp(38))
        call iovxxx(w14, w41, w9, gwf, amp(39))
        call iovxxx(w7, w59, w10, gwf, amp(41))
        call iovxxx(w7, w61, w10, gwf, amp(42))
        call vvvxxx(w9, w10, w58, gwwa, amp(43))
        call vvvxxx(w9, w10, w60, gwwz, amp(44))
        call vvsxxx(w9, w10, w62, gwwh, amp(45))
        call iovxxx(w21, w8, w60, gzn, amp(46))
        call iosxxx(w21, w8, w62, gchf(1,6), amp(47))
        call iovxxx(w5, w22, w58, gal, amp(48))
        call iovxxx(w5, w22, w60, gzl, amp(49))
        call iosxxx(w5, w22, w62, gchf(1,5), amp(50))
        call iovxxx(w7, w23, w60, gzn, amp(51))
        call iovxxx(w63, w11, w1, gg, amp(52))
        call iovxxx(w57, w11, w9, gwf, amp(53))
        call iovxxx(w4, w66, w9, gwf, amp(54))
        call iovxxx(w5, w8, w69, gwf, amp(55))
        call iovxxx(w5, w8, w72, gwf, amp(56))
        call vvvxxx(w9, w10, w67, gwwa, amp(57))
        call vvvxxx(w9, w10, w70, gwwz, amp(58))
        call vvsxxx(w9, w10, w73, gwwh, amp(59))
        call iovxxx(w5, w74, w9, gwf, amp(60))
        call iovxxx(w5, w75, w9, gwf, amp(61))
        call iovxxx(w76, w8, w9, gwf, amp(62))
        call iovxxx(w77, w8, w9, gwf, amp(63))
        call iovxxx(w78, w8, w9, gwf, amp(64))
        call iovxxx(w79, w6, w10, gwf, amp(65))
        call iovxxx(w12, w80, w2, gg, amp(66))
        call iovxxx(w5, w8, w83, gwf, amp(67))
        call iovxxx(w5, w8, w86, gwf, amp(68))
        call vvvxxx(w9, w10, w81, gwwa, amp(69))
        call vvvxxx(w9, w10, w84, gwwz, amp(70))
        call vvsxxx(w9, w10, w87, gwwh, amp(71))
        call iovxxx(w5, w88, w9, gwf, amp(72))
        call iovxxx(w5, w89, w9, gwf, amp(73))
        call iovxxx(w90, w8, w9, gwf, amp(74))
        call iovxxx(w91, w8, w9, gwf, amp(75))
        call iovxxx(w92, w8, w9, gwf, amp(76))
        call iovxxx(w93, w6, w10, gwf, amp(77))
        call iovxxx(w56, w80, w9, gwf, amp(78))
        call iovxxx(w5, w8, w98, gwf, amp(80))
        call iovxxx(w5, w8, w101,gwf, amp(81))
        call vvvxxx(w9, w10, w96, gwwa, amp(82))
        call vvvxxx(w9, w10, w99, gwwz, amp(83))
        call vvsxxx(w9, w10, w102,gwwh, amp(84))
        call iovxxx(w5, w103, w9, gwf, amp(85))
        call iovxxx(w5, w104, w9, gwf, amp(86))
        call iovxxx(w105, w8, w9, gwf, amp(87))
        call iovxxx(w106, w8, w9, gwf, amp(88))
        call iovxxx(w107, w8, w9, gwf, amp(89))
        call iovxxx(w108, w6, w10, gwf, amp(90))
        call iovxxx(w95, w11, w9, gwf, amp(91))
        call iovxxx(w4, w110, w9, gwf, amp(92))
        call iovxxx(w5, w8, w113,gwf, amp(93))
        call iovxxx(w5, w8, w116,gwf, amp(94))
        call vvvxxx(w9, w10, w111,gwwa, amp(95))
        call vvvxxx(w9, w10, w114,gwwz, amp(96))
        call vvsxxx(w9, w10, w117,gwwh, amp(97))
        call iovxxx(w5, w118, w9, gwf, amp(98))
        call iovxxx(w5, w119, w9, gwf, amp(99))
        call iovxxx(w120, w8, w9, gwf, amp(100))
        call iovxxx(w121, w8, w9, gwf, amp(101))
        call iovxxx(w122, w8, w9, gwf, amp(102))
        call iovxxx(w123, w6, w10, gwf, amp(103))
    end if

    gg_bbemuvevm = 0.d0
    do i = 1, neigen
        ztemp = (0.d0, 0.d0)
        do j = 1, ngraphs
            ztemp = ztemp + eigen_vec(j,i)*amp(j)
        enddo
        gg_bbemuvevm = gg_bbemuvevm + ztemp*eigen_val(i)*conjg(ztemp)
    enddo
    ! call gaugecheck(amp,ztemp,eigen_vec,eigen_val,ngraphs,neigen)
end function gg_bbemuvevm
